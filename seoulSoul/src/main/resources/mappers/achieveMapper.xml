<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="achieveMapper">

    <resultMap type="com.multi.seoulsoul.achieve.model.dto.AchLocaDTO" id="achLocaResultMap">
        <id property="achNo" column="ach_no"/>
        <result property="locationCode" column="location_code"/>
        <result property="maxCount" column="max_count"/>
        <result property="title" column="title"/>
        <result property="createdDate" column="created_date"/>
        <result property="modifiedDate" column="modified_date"/>
    </resultMap>

    <resultMap type="com.multi.seoulsoul.achieve.model.dto.AchLocaCountDTO" id="achLocaCountResultMap">
        <id property="userNo" column="user_no"/>
        <result property="curCount" column="cur_count"/>
        <association property="achLoca" column="ach_no" javaType="com.multi.seoulsoul.achieve.model.dto.AchLocaDTO" select="selectAchLocaById"/>
    </resultMap>

    <resultMap type="com.multi.seoulsoul.achieve.model.dto.AchLocaGetDTO" id="achLocaGetResultMap">
        <id property="userNo" column="user_no"/>
        <result property="status" column="status"/>
        <association property="achLoca" column="ach_no" javaType="com.multi.seoulsoul.achieve.model.dto.AchLocaDTO" select="selectAchLocaById"/>
    </resultMap>

    <resultMap type="com.multi.seoulsoul.achieve.model.dto.AchLocaIconsDTO" id="achLocaIconsResultMap">
        <id property="iconNo" column="icon_no"/>
        <result property="originalName" column="original_name"/>
        <result property="savedName" column="saved_name"/>
        <association property="achLoca" column="ach_no" javaType="com.multi.seoulsoul.achieve.model.dto.AchLocaDTO" select="selectAchLocaById"/>
    </resultMap>

    <resultMap type="com.multi.seoulsoul.achieve.model.dto.AchCateDTO" id="achCateResultMap">
        <id property="achNo" column="ach_no"/>
        <result property="categoryCode" column="category_code"/>
        <result property="maxCount" column="max_count"/>
        <result property="title" column="title"/>
        <result property="createdDate" column="created_date"/>
        <result property="modifiedDate" column="modified_date"/>
    </resultMap>

    <resultMap type="com.multi.seoulsoul.achieve.model.dto.AchCateCountDTO" id="achCateCountResultMap">
        <id property="userNo" column="user_no"/>
        <result property="curCount" column="cur_count"/>
        <association property="achCate" column="ach_no" javaType="com.multi.seoulsoul.achieve.model.dto.AchCateDTO" select="selectAchCateById"/>
    </resultMap>

    <resultMap type="com.multi.seoulsoul.achieve.model.dto.AchCateGetDTO" id="achCateGetResultMap">
        <id property="userNo" column="user_no"/>
        <result property="status" column="status"/>
        <association property="achCate" column="ach_no" javaType="com.multi.seoulsoul.achieve.model.dto.AchCateDTO" select="selectAchCateById"/>
    </resultMap>

    <resultMap type="com.multi.seoulsoul.achieve.model.dto.AchCateIconsDTO" id="achCateIconsResultMap">
        <id property="iconNo" column="icon_no"/>
        <result property="originalName" column="original_name"/>
        <result property="savedName" column="saved_name"/>
        <association property="achCate" column="ach_no" javaType="com.multi.seoulsoul.achieve.model.dto.AchCateDTO" select="selectAchCateById"/>
    </resultMap>
    
    <select id="selectAchLocaById" resultMap="achLocaResultMap">
        SELECT ach_no, location_code, max_count, title, created_date, modified_date
        FROM ACH_LOCA
        WHERE ach_no = #{achNo}
    </select>

    <select id="selectAchCateById" resultMap="achCateResultMap">
        SELECT ach_no, category_code, max_count, title, created_date, modified_date
        FROM ACH_CATE
        WHERE ach_no = #{achNo}
    </select>
	
	<insert id="insertAchieveLoca" parameterType="achLocaDTO" useGeneratedKeys="true" keyProperty="achNo">
		insert into ACH_LOCA (location_code, max_count, title)
		values (#{locationCode}, #{maxCount}, #{title})
	</insert>
	
	<insert id="insertAchieveCate" parameterType="achCateDTO" useGeneratedKeys="true" keyProperty="achNo">
		insert into ACH_CATE (category_code, max_count, title)
		values (#{categoryCode}, #{maxCount}, #{title})
	</insert>
	
	<insert id="insertLocaIcons" parameterType="com.multi.seoulsoul.achieve.model.dto.AchLocaIconsDTO">
		insert into ACH_LOCA_ICONS
		values (null, #{achLoca.achNo}, #{originalName}, #{savedName})
	</insert>
	
	<insert id="insertCateIcons" parameterType="com.multi.seoulsoul.achieve.model.dto.AchCateIconsDTO">
		insert into ACH_CATE_ICONS
		values (null, #{achCate.achNo}, #{originalName}, #{savedName})
	</insert>
	
	<select id="selectAchieveLoca" resultType="achLocaDTO">
		select * from ACH_LOCA
	</select>
	
	<select id="selectAchieveCate" resultType="achCateDTO">
		select * from ACH_CATE
	</select>
    
    <select id="selectAchLocaIconsByAchNo" resultType="com.multi.seoulsoul.achieve.model.dto.AchLocaIconsDTO">
        SELECT * FROM ACH_LOCA_ICONS WHERE ach_no = #{achNo}
    </select>
    
    <select id="selectAchCateIconsByAchNo" resultType="com.multi.seoulsoul.achieve.model.dto.AchCateIconsDTO">
        SELECT * FROM ACH_CATE_ICONS WHERE ach_no = #{achNo}
    </select>
	
	<select id="findAllAchLoca" resultType="achLocaDTO">
        select * from ACH_LOCA
        order by ach_no
        limit #{pageable.offset}, #{pageable.pageSize}
    </select>

    <select id="findAllAchCate" resultType="achCateDTO">
        select * from ACH_CATE
        order by ach_no
        limit #{pageable.offset}, #{pageable.pageSize}
    </select>
    
    <update id="updateAchLoca" parameterType="com.multi.seoulsoul.achieve.model.dto.AchLocaDTO">
        UPDATE ACH_LOCA
        SET location_code = #{locationCode},
            max_count = #{maxCount},
            title = #{title},
            modified_date = CURRENT_TIMESTAMP
        WHERE ach_no = #{achNo}
    </update>

    <update id="updateLocaIcons" parameterType="com.multi.seoulsoul.achieve.model.dto.AchLocaIconsDTO">
        UPDATE ACH_LOCA_ICONS
        SET original_name = #{originalName},
            saved_name = #{savedName}
        WHERE ach_no = #{achLoca.achNo}
    </update>
    
    <update id="updateAchCate" parameterType="com.multi.seoulsoul.achieve.model.dto.AchCateDTO">
        UPDATE ACH_CATE
        SET category_code = #{categoryCode},
            max_count = #{maxCount},
            title = #{title},
            modified_date = CURRENT_TIMESTAMP
        WHERE ach_no = #{achNo}
    </update>

    <update id="updateCateIcons" parameterType="com.multi.seoulsoul.achieve.model.dto.AchCateIconsDTO">
        UPDATE ACH_CATE_ICONS
        SET original_name = #{originalName},
            saved_name = #{savedName}
        WHERE ach_no = #{achCate.achNo}
    </update>
	
	<delete id="deleteAchieveLoca" parameterType="int">
		delete from ACH_LOCA where ach_no = #{achNo}
	</delete>
	
	<delete id="deleteAchieveCate" parameterType="int">
		delete from ACH_CATE where ach_no = #{achNo}
	</delete>
	
</mapper>